<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libode: rkab.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libode
   </div>
   <div id="projectbrief">A small library of ODE solvers.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rkab.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Templates for adaptive step size Runge-Kutta solver.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;alloca.h&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;boost/math/special_functions/ulp.hpp&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &lt;type_traits&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
</div>
<p><a href="rkab_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structresults__rkab.html">results_rkab&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure template for the return type of adaptive step size Runge-Kutta methods.  <a href="structresults__rkab.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a44a9cd339e0494846e22f77afc4caeb2"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a44a9cd339e0494846e22f77afc4caeb2"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="rkab_8hpp.html#a44a9cd339e0494846e22f77afc4caeb2">delete_results_rkab</a> (<a class="el" href="structresults__rkab.html">results_rkab</a>&lt; T &gt; *results)</td></tr>
<tr class="memdesc:a44a9cd339e0494846e22f77afc4caeb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function template for deleting <a class="el" href="structresults__rkab.html" title="Structure template for the return type of adaptive step size Runge-Kutta methods. ...">results_rkab</a> instances.  <a href="#a44a9cd339e0494846e22f77afc4caeb2">More...</a><br /></td></tr>
<tr class="separator:a44a9cd339e0494846e22f77afc4caeb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df14702d3a530d7c8f7eb1de4507dc4"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a8df14702d3a530d7c8f7eb1de4507dc4"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="rkab_8hpp.html#a8df14702d3a530d7c8f7eb1de4507dc4">acceptability_rel</a> (int dim, T *ua, T *ub, T tol)</td></tr>
<tr class="memdesc:a8df14702d3a530d7c8f7eb1de4507dc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function template for calculating relative acceptability for scalar tolerance.  <a href="#a8df14702d3a530d7c8f7eb1de4507dc4">More...</a><br /></td></tr>
<tr class="separator:a8df14702d3a530d7c8f7eb1de4507dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33287796b0ff0f1cad050f862f3f1548"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a33287796b0ff0f1cad050f862f3f1548"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="rkab_8hpp.html#a33287796b0ff0f1cad050f862f3f1548">acceptability_rel</a> (int dim, T *ua, T *ub, T *tol)</td></tr>
<tr class="memdesc:a33287796b0ff0f1cad050f862f3f1548"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function template for calculating relative acceptability for an array of tolerances.  <a href="#a33287796b0ff0f1cad050f862f3f1548">More...</a><br /></td></tr>
<tr class="separator:a33287796b0ff0f1cad050f862f3f1548"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a226731a032ba56f49bb353c2a81a0445"><td class="memTemplParams" colspan="2">template&lt;typename T , typename tolT &gt; </td></tr>
<tr class="memitem:a226731a032ba56f49bb353c2a81a0445"><td class="memTemplItemLeft" align="right" valign="top">struct <a class="el" href="structresults__rkab.html">results_rkab</a>&lt; T &gt; *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="rkab_8hpp.html#a226731a032ba56f49bb353c2a81a0445">rkab</a> (const int astages, const int bstages, const T *ba, const T *bb, const T *a, const T *c, T *u_init, int dim, int maxsteps, tolT tol, T t, T t_end, void(*get_f)(T, T *, T *))</td></tr>
<tr class="memdesc:a226731a032ba56f49bb353c2a81a0445"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function template for adaptive step size Runge-Kutta methods.  <a href="#a226731a032ba56f49bb353c2a81a0445">More...</a><br /></td></tr>
<tr class="separator:a226731a032ba56f49bb353c2a81a0445"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Templates for adaptive step size Runge-Kutta solver. </p>
<p>Provides a template <a class="el" href="rkab_8hpp.html#a226731a032ba56f49bb353c2a81a0445" title="Function template for adaptive step size Runge-Kutta methods. ">rkab()</a> for adaptive Runge-Kutta functions of arbitrary Butcher tableau and floating-point compatible data type, which accept tolerance as either a number or an array. Provides templates for the return type of <a class="el" href="rkab_8hpp.html#a226731a032ba56f49bb353c2a81a0445" title="Function template for adaptive step size Runge-Kutta methods. ">rkab()</a> and its API, and templates for auxilliary functions used by <a class="el" href="rkab_8hpp.html#a226731a032ba56f49bb353c2a81a0445" title="Function template for adaptive step size Runge-Kutta methods. ">rkab()</a>. </p><dl class="section author"><dt>Author</dt><dd>Jeremiah O'Neil </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU Public License. </dd></dl>

<p class="definition">Definition in file <a class="el" href="rkab_8hpp_source.html">rkab.hpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8df14702d3a530d7c8f7eb1de4507dc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8df14702d3a530d7c8f7eb1de4507dc4">&#9670;&nbsp;</a></span>acceptability_rel() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T acceptability_rel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>ua</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>ub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function template for calculating relative acceptability for scalar tolerance. </p>
<p>I define acceptability as the minimum over all elements of the ratio of tolerance to error. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim</td><td>The dimension of the system. </td></tr>
    <tr><td class="paramname">ua</td><td>A proposed state of the system. </td></tr>
    <tr><td class="paramname">ub</td><td>A proposed state of the system computed to a higher order. </td></tr>
    <tr><td class="paramname">tol</td><td>The relative tolerance for the local error of the system. </td></tr>
  </table>
  </dd>
</dl>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Floating-point compatible data type. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rkab_8hpp_source.html#l00062">62</a> of file <a class="el" href="rkab_8hpp_source.html">rkab.hpp</a>.</p>

</div>
</div>
<a id="a33287796b0ff0f1cad050f862f3f1548"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33287796b0ff0f1cad050f862f3f1548">&#9670;&nbsp;</a></span>acceptability_rel() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T acceptability_rel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>ua</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>ub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function template for calculating relative acceptability for an array of tolerances. </p>
<p>Overload of the scalar method for "tol" a pointer type, assumedly to an array of tolerances, one for each component of u. I define acceptability as the minimum over all elements of the ratio of tolerance to error. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim</td><td>The dimension of the system. </td></tr>
    <tr><td class="paramname">ua</td><td>A proposed state of the system. </td></tr>
    <tr><td class="paramname">ub</td><td>A proposed state of the system computed to a higher order. </td></tr>
    <tr><td class="paramname">tol</td><td>A pointer to an array of relative tolerances for the local error of the system. </td></tr>
  </table>
  </dd>
</dl>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Floating-point compatible data type. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rkab_8hpp_source.html#l00084">84</a> of file <a class="el" href="rkab_8hpp_source.html">rkab.hpp</a>.</p>

</div>
</div>
<a id="a44a9cd339e0494846e22f77afc4caeb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a9cd339e0494846e22f77afc4caeb2">&#9670;&nbsp;</a></span>delete_results_rkab()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void delete_results_rkab </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structresults__rkab.html">results_rkab</a>&lt; T &gt; *&#160;</td>
          <td class="paramname"><em>results</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function template for deleting <a class="el" href="structresults__rkab.html" title="Structure template for the return type of adaptive step size Runge-Kutta methods. ...">results_rkab</a> instances. </p>
<p>The destructor of <a class="el" href="structresults__rkab.html" title="Structure template for the return type of adaptive step size Runge-Kutta methods. ...">results_rkab</a>, separated from the structure for C programs to release the memory via callback. </p>

<p class="definition">Definition at line <a class="el" href="rkab_8hpp_source.html#l00045">45</a> of file <a class="el" href="rkab_8hpp_source.html">rkab.hpp</a>.</p>

</div>
</div>
<a id="a226731a032ba56f49bb353c2a81a0445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a226731a032ba56f49bb353c2a81a0445">&#9670;&nbsp;</a></span>rkab()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename tolT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structresults__rkab.html">results_rkab</a>&lt; T &gt;* rkab </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>astages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>bstages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>ba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>bb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>u_init</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxsteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tolT&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>t_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(T, T *, T *)&#160;</td>
          <td class="paramname"><em>get_f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function template for adaptive step size Runge-Kutta methods. </p>
<p>Solves a given system over parameterized domain to given relative tolerance in local error. Dynamically allocates memory for the solution and returns a pointer to a <a class="el" href="structresults__rkab.html" title="Structure template for the return type of adaptive step size Runge-Kutta methods. ...">results_rkab</a> instance containing that solution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">astages,bstages,ba,bb,a,c</td><td>Modified extended Butcher tableau to be bound on instantiation, defining a particular method. In relation to a standard extended Butcher tableau, 'a' is expected to be transposed and flattened with the zero half removed and 'ba' and 'c' to have the trailing and leading zeroes respectively removed. 'astages' and 'bstages' are the number of stages of the low- and high-order methods respectively. </td></tr>
    <tr><td class="paramname">u_init</td><td>The initial state array of the system. </td></tr>
    <tr><td class="paramname">dim</td><td>The dimension of the system. </td></tr>
    <tr><td class="paramname">maxsteps</td><td>The maximum number of iterations to run. </td></tr>
    <tr><td class="paramname">tol</td><td>The relative tolerance or a pointer to an array of relative tolerances for the local error of the system at each step. </td></tr>
    <tr><td class="paramname">t</td><td>The initial value of the system parameter. </td></tr>
    <tr><td class="paramname">t_end</td><td>The target value of the system parameter. </td></tr>
    <tr><td class="paramname">get_f</td><td>A callback function get_f(t, *u_t, *f) which writes the derivative of u at system parameter t and state u_t to array f. </td></tr>
  </table>
  </dd>
</dl>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Floating-point compatible data type. </td></tr>
    <tr><td class="paramname">Ttol</td><td>Tolerance type: should be (scalar) T or (array) T*. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rkab_8hpp_source.html#l00115">115</a> of file <a class="el" href="rkab_8hpp_source.html">rkab.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
